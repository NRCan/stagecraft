language: python
python:
  - "2.7"
  - "3.3"
install: 
  - pip install -r requirements/ci.txt --use-mirrors
env:
  matrix:
  - DJANGO_SETTINGS_MODULE=stagecraft.settings.ci SECRET_KEY=xyz DATABASE_URL=postgres://a:b@foo:999/db
  global:
    # NOTE: contains GH_TOKEN=xxx from github user gds-pp-ci
    secure: gY2BW8rNmXa3oc2mWv0a3780E+DEOh4ETXfz1DVDACuOMbm3PXzu5TRvAN4XcKc8biUlCHyx8ReeZzcya5M3/4dQA9LYBdSzXb4JFcWpYyxIKwrqQVeKbR79BNTYLGtJ700uJRV2lXqvLSZJD5A8CaLeoNhlBKIBjZaE1+z07Is=
script:
  - ./run_tests.sh
after_script:
  - coveralls
after_success:
  - ./.travis_scripts/push_release_tag.sh
branches:
  except:
    - release
    - /^release_\d+$/
notifications:
  email: false
